# هدف پروژه: داشبورد مدیریتی مدل‌سازی سیستم دینامیک با معماری BPTK-Py + Grafana

این پروژه با هدف ایجاد یک داشبورد مدیریتی اپن‌سورس پیشرفته بر پایه معماری ترکیبی **BPTK-Py + Grafana** توسعه می‌یابد؛ معماری‌ای که در دنیای مدل‌سازی و شبیه‌سازی سیستم‌ها پیشنهاد می‌شود و راهکاری فوق‌العاده منعطف و مقیاس‌پذیر برای تیم‌ها و سازمان‌هایی است که نیاز به ابزارهای مدل‌سازی، شبیه‌سازی و مصورسازی داده دارند.  
یکی از اهداف کلیدی این پروژه، **ایجاد سطوح دسترسی متفاوت برای افراد (ادمین، تحلیل‌گر، کاربر عادی و...)** و حرکت تدریجی از قابلیت‌های پایه به پیشرفته است.

---

## مسیر توسعه پروژه و فازبندی قابلیت‌ها

۱. **شروع با نمودارهای علی و معلولی (Causal Loop Diagrams):**
   - هدف اولیه: ساخت داشبورد برای نمایش و تعامل با نمودارهای علی و معلولی.
   - امکان تعریف متغیرها، حلقه‌های بازخورد و مشاهده اثرات متقابل.

۲. **گسترش به سمت نمودارهای سیستمی (System Diagrams):**
   - افزودن امکانات Stock & Flow و مدل‌سازی اجزای سیستمی.
   - پشتیبانی از سناریو و نمایش جریان منابع.

۳. **افزودن تحلیل‌های سری زمانی (Time Series):**
   - ذخیره و نمایش خروجی مدل‌ها به شکل سری زمانی و مقایسه سناریوها.

۴. **توسعه به سمت شبیه‌سازی و سناریوسازی پیشرفته:**
   - اجرای مدل‌ها با پارامترهای مختلف، تحلیل حساسیت و عدم‌قطعیت، بهینه‌سازی و گزارش‌های مدیریتی.

---

## اجزای کلیدی معماری

### ۱. BPTK-Py (Business Prototyping Toolkit for Python)
- پلتفرم متن‌باز پایتونی برای مدل‌سازی و شبیه‌سازی سیستم دینامیک و عامل‌محور
- پشتیبانی از Stock & Flow، Causal Loop، Agent-Based Modeling
- امکان سناریوسازی، تحلیل حساسیت و ذخیره داده در دیتابیس یا DataFrame

### ۲. Grafana
- داشبورد اپن‌سورس برای مصورسازی و تحلیل داده‌های زمان‌محور
- پلاگین‌پذیر و قابل اتصال به دیتابیس‌های مختلف، فایل و API
- ساخت داشبوردهای پویا و سطوح دسترسی (RBAC) و گزارش‌گیری پیشرفته
- امکان تعریف **سطوح دسترسی متفاوت** برای مشاهده/ویرایش بسته به نقش کاربر

### ۳. اتصال و یکپارچه‌سازی
- اجرای مدل در BPTK-Py و ذخیره خروجی در پایگاه داده (PostgreSQL، InfluxDB یا CSV/JSON)
- خواندن داده‌ها و ساخت داشبورد مدیریتی تعاملی در Grafana
- ادغام با مدل‌های Vensim و AnyLogic از طریق PySD یا API

---

## مزایای معماری

- **انعطاف‌پذیری کامل:** هر لایه قابل تعویض و سفارشی‌سازی
- **مقیاس‌پذیری بالا:** اجرا روی سرور داخلی، ابری یا Kubernetes
- **پشتیبانی از انواع مدل و سناریو:** از نمودار علی و معلولی تا شبیه‌سازی پیچیده
- **امنیت و کنترل:** سطوح دسترسی، RBAC و مدیریت داده‌های حساس
- **گسترش‌پذیری تدریجی:** قابلیت افزودن امکانات و ارتقا از سطح ساده به پیشرفته

---

## نمونه گردش کار

۱. تعریف مدل سیستم داینامیک (مثلاً Vensim یا PySD)
۲. بارگذاری مدل در BPTK-Py و اجرای سناریوها
۳. ذخیره خروجی مدل در دیتابیس یا فایل
۴. ساخت داشبورد در Grafana (شروع با نمودار علی و معلولی، سپس Stock & Flow، سری زمانی و ...)
۵. تنظیم سطوح دسترسی برای مشاهده یا ویرایش بسته به نقش کاربر
۶. اشتراک‌گذاری، مقایسه داشبوردها و دریافت گزارش

---

## ادغام با ابزارهای دیگر

- **Vensim:** مدل را به XMILE یا Vensim export و با PySD یا BPTK-Py اجرا کن
- **AnyLogic:** اتصال خروجی یا API AnyLogic به BPTK-Py و نمایش در Grafana

---

### اجرای سریع با Docker Compose

برای راه‌اندازی پایگاه داده PostgreSQL و Grafana به صورت سریع می‌توانید از فایل `docker-compose.yml` استفاده کنید:

```bash
docker-compose up -d
```

پس از بالا آمدن سرویس‌ها، اجرای شبیه‌سازی و ذخیره نتایج در دیتابیس با دستور زیر امکان‌پذیر است:

```bash
python simulate.py --db-url postgresql://bptk:bptkpass@localhost:5432/bptkdb
```

---

## جمع‌بندی

این معماری، داشبورد مدیریتی اپن‌سورس پیشرفته با قابلیت رشد تدریجی، پوشش نیازهای ساده تا پیشرفته، سطوح دسترسی متنوع و اتصال ابزارهای تخصصی را به صورت یکپارچه فراهم می‌کند.
